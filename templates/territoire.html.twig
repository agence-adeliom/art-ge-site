{% extends 'base.html.twig' %}

{% block title %}Territoire {{ territoire.name }}{% endblock %}

{% block body %}

    {{ dump() }}

    <div>Nombres de réponses : {{ reponses.numberOfReponses }}</div>
    <div>Typologies : {{ query.typologies is empty ? 'Toutes' : query.typologies | join(', ') }}</div>
    <div>Restauration : {{ query.restauration is defined ? 'N/A' : (query.restauration ? 'Oui' : 'Non') }}</div>
    <div>Espace vert : {{ query.greenSpace is defined ? 'N/A' : (query.greenSpace ? 'Oui' : 'Non') }}</div>

    <h1 class="font-bold">Pourcentage Total</h1>
    {{ display_percentage(scores.percentageGlobal) }}
    <h2 class="font-bold mt-4">Scores par thématique</h2>
    {% for percentage in scores.percentagesByThematiques %}
        <h3 class="font-bold mt-2">{{ percentage.name }}</h3>
        {{ display_percentage(percentage.value) }}
    {% endfor %}

    {% if territoire.area.value == 'region' %}
        <h2 class="font-bold mt-4">Liste des département du {{ territoire.name }}</h2>
        {% if children is not empty %}
            <ul class="grid">
                {% for child in children %}
                    <li>
                        <div><a href="{{ url('app_territoire_single', { identifier: child.slug }) }}">{{ child.name }}</a></div>
                    </li>
                {% endfor %}
            </ul>
        {% endif %}
    {% endif %}

    {% if territoire.area.value == 'departement' %}
        <h2 class="font-bold mt-4">Liste des OT du {{ territoire.name }}</h2>
        {% if children is not empty %}
            <ul class="grid">
                {% for child in children %}
                    <li>
                        <div><a href="{{ url('app_territoire_single', { identifier: child.slug }) }}">{{ child.name }}</a></div>
                    </li>
                {% endfor %}
            </ul>
        {% endif %}
    {% endif %}

    <h2 class="font-bold mt-4">Liste des répondants</h2>
    {% if reponses.repondants is not empty %}
        <ul class="grid">
        {% for repondant in reponses.repondants %}
            <li>
                <div>{{ repondant.typologie }}</div>
                <div><a href="{{ url('app_resultat_single', { uuid: repondant.uuid }) }}">{{ repondant.company }}</a></div>
                <div>{{ display_percentage(repondant.points, repondant.total) }}</div>
            </li>
        {% endfor %}
        </ul>
    {% endif %}
{% endblock %}
